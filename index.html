<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Game Selection</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- LOADING SCREEN -->
  <div id="loadingScreen">
    <div class="meeple-container">
      <svg class="meeple" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
        <path d="M50 10 C45 10 40 15 40 20 C40 25 42 28 45 30 L42 50 L35 85 L40 90 L50 70 L60 90 L65 85 L58 50 L55 30 C58 28 60 25 60 20 C60 15 55 10 50 10 Z" 
              fill="white" 
              stroke="black" 
              stroke-width="2"/>
        <circle cx="50" cy="20" r="8" fill="white" stroke="black" stroke-width="2"/>
      </svg>
    </div>
  </div>

  <!-- Pulsante Admin -->
  <button id="adminBtn" class="admin-icon" title="Admin">‚öôÔ∏è</button>
  
  <!-- Titolo -->
  <h1>Seleziona a cosa giocare</h1>
  
  <!-- Sezione Filtri -->
  <div id="filterSection">
    <div class="filter-header" id="filterHeader">
      <h2>Filtri</h2>
      <span class="filter-toggle collapsed">‚ñº</span>
    </div>
    <div class="filter-content collapsed" id="filterContent">
      <div class="filter-group">
        <h3>Categoria</h3>
        <div id="categoryFilters" class="filter-buttons"></div>
      </div>
      <div class="filter-group">
        <h3>Filtri Partita</h3>
        <div id="tagFilters" class="filter-buttons"></div>
      </div>
      <button id="clearFilters" class="clear-filters" style="display:none;">Rimuovi tutti i filtri</button>
    </div>
  </div>
  
  <!-- Griglia giochi -->
  <div id="grid"></div>
  
  <!-- Pulsante invia selezione -->
  <button id="submitBtn">Invia selezione</button>
  
  <!-- Sezione nome partecipante -->
  <div id="nameSection" class="hidden">
    <div class="modal-box">
      <button id="closeNameSection">‚úñ</button>
      <h2>Nome del partecipante</h2>
      <input id="nameInput" placeholder="Anonimo se vuoto" />
      <button id="send">Invia</button>
    </div>
  </div>
  
  <!-- ADMIN PANEL -->
  <div id="adminPanel" class="hidden">
    <div class="admin-modal">
      <button id="closeAdminBtn">‚úñ</button>
      
      <!-- Sezione password -->
      <div id="adminPasswordSection">
        <h2>Accesso Admin</h2>
        <input type="password" id="adminPasswordInput" placeholder="Password" />
        <button id="adminLoginBtn" class="admin-btn">Accedi</button>
      </div>
      
      <!-- Contenuto admin -->
      <div id="adminContent" class="hidden">
        <h2>Pannello Admin</h2>
        
        <!-- Filtro Date -->
        <div class="date-filter">
          <h3>Filtra per Data</h3>
          <div class="date-inputs">
            <label>
              Da:
              <input type="date" id="dateFrom">
            </label>
            <label>
              A:
              <input type="date" id="dateTo">
            </label>
            <button id="applyDateFilter">Applica</button>
            <button id="resetDateFilter" style="background:#dc3545;">Reset</button>
          </div>
        </div>
        
        <!-- Grafico -->
        <div id="chartContainer">
          <canvas id="voteChart" height="300"></canvas>
        </div>
        
        <!-- Tabella voti -->
        <div id="votesTable"></div>
        
        <!-- Pulsante reset -->
        <button id="resetDataBtn" class="reset-btn">üóëÔ∏è Cancella Tutti i Dati</button>
      </div>
    </div>
  </div>
  
  <!-- POPUP -->
  <div id="popupOverlay" class="popup-overlay">
    <div class="popup-content">
      <div id="popupClose" class="popup-close">√ó</div>
      <div id="popupText"></div>
    </div>
  </div>
  
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
